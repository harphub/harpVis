<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content='This function plots a time series of data from a harp_point_df data frame,
or a harp_list containing harp_point_df data frames. The plotting is done
using ggplot2 and thus uses some of
the same terminology in its arguments. Data are plotted using "geoms", and
the plots are divided into panels using facets. If the data contain a column
of observed values these may also be included in the plot, and for ensemble
data a best guess forecast may be derived from the data.'><title>Plot a time series for point data — plot_station_ts • harpVis</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plot a time series for point data — plot_station_ts"><meta property="og:description" content='This function plots a time series of data from a harp_point_df data frame,
or a harp_list containing harp_point_df data frames. The plotting is done
using ggplot2 and thus uses some of
the same terminology in its arguments. Data are plotted using "geoms", and
the plots are divided into panels using facets. If the data contain a column
of observed values these may also be included in the plot, and for ensemble
data a best guess forecast may be derived from the data.'><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">harpVis</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/harphub/harpVis/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Plot a time series for point data</h1>
      <small class="dont-index">Source: <a href="https://github.com/harphub/harpVis/blob/HEAD/R/plot_station_ts.R" class="external-link"><code>R/plot_station_ts.R</code></a></small>
      <div class="d-none name"><code>plot_station_ts.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function plots a time series of data from a <code>harp_point_df</code> data frame,
or a <code>harp_list</code> containing <code>harp_point_df</code> data frames. The plotting is done
using <a href="https://ggplot2.tidyverse.org/" class="external-link">ggplot2</a> and thus uses some of
the same terminology in its arguments. Data are plotted using "geoms", and
the plots are divided into panels using facets. If the data contain a column
of observed values these may also be included in the plot, and for ensemble
data a best guess forecast may be derived from the data.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plot_station_ts</span><span class="op">(</span></span>
<span>  <span class="va">.data</span>,</span>
<span>  <span class="va">SID</span>,</span>
<span>  <span class="va">fcst_dttm</span>,</span>
<span>  x_axis <span class="op">=</span> <span class="st">"lead_time"</span>,</span>
<span>  fcst_geom <span class="op">=</span> <span class="st">"line"</span>,</span>
<span>  fcst_geom_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  fcst_colour_by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  fcst_colours <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  obs_col <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  obs_geom <span class="op">=</span> <span class="st">"point"</span>,</span>
<span>  obs_geom_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  facet_by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  num_facet_cols <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  facet_scales <span class="op">=</span> <span class="st">"free_y"</span>,</span>
<span>  smooth <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for harp_ens_point_df</span></span>
<span><span class="fu">plot_station_ts</span><span class="op">(</span></span>
<span>  <span class="va">.data</span>,</span>
<span>  <span class="va">SID</span>,</span>
<span>  <span class="va">fcst_dttm</span>,</span>
<span>  x_axis <span class="op">=</span> <span class="st">"lead_time"</span>,</span>
<span>  fcst_geom <span class="op">=</span> <span class="st">"boxplot"</span>,</span>
<span>  fcst_geom_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  fcst_colour_by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  fcst_colours <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  obs_col <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  obs_geom <span class="op">=</span> <span class="st">"point"</span>,</span>
<span>  obs_geom_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  facet_by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  num_facet_cols <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  facet_scales <span class="op">=</span> <span class="st">"free_y"</span>,</span>
<span>  smooth <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  quantiles <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  best_guess <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  best_guess_geom <span class="op">=</span> <span class="st">"line"</span>,</span>
<span>  best_guess_geom_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>.data</dt>
<dd><p>A <code>harp_point_df</code> data frame, or a <code>harp_list</code> containing
<code>harp_point_df</code> data frames.</p></dd>


<dt>SID</dt>
<dd><p>The ID of the station(s) to plot. If more than one SID is asked
for then <code>SID</code> should be included in <code>facet_by</code>.</p></dd>


<dt>fcst_dttm</dt>
<dd><p>The start time(s) of the the forecast to plot. If more than
one <code>fcst_dttm</code> is asked for, <code>fcst_dttm</code> should be included in <code>facet_by</code>.</p></dd>


<dt>x_axis</dt>
<dd><p>The x axis of the plot.</p></dd>


<dt>fcst_geom</dt>
<dd><p>The geom to use to plot the forecast data (see details).</p></dd>


<dt>fcst_geom_args</dt>
<dd><p>Arguments to the <code>fcst_geom</code> geom as a named list.</p></dd>


<dt>fcst_colour_by</dt>
<dd><p>Which column in <code>.data</code> to use to control the colours
of the forecast data.</p></dd>


<dt>fcst_colours</dt>
<dd><p>A vector of colours to use for the forecast data. It
should be the same length as the number of colours to appear in the plot.
Where the colours are a controlled by the data, this can be a named vector
or a data frame with column names equal to the column in the data
controlling the colour and "colour".</p></dd>


<dt>obs_col</dt>
<dd><p>If observations are to be included in the plot, the column
containing the observations data.</p></dd>


<dt>obs_geom</dt>
<dd><p>The geom to use to plot the observations data.</p></dd>


<dt>obs_geom_args</dt>
<dd><p>Arguments to the <code>obs_geom</code> geom as a named list.</p></dd>


<dt>facet_by</dt>
<dd><p>The column(s) to use to facet the plot into panels.</p></dd>


<dt>num_facet_cols</dt>
<dd><p>The number of columns in a faceted plot.</p></dd>


<dt>facet_scales</dt>
<dd><p>Whether the scales should be fixed. Defaults to
<code>"free_y"</code>. See <code><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></code> for more details.</p></dd>


<dt>smooth</dt>
<dd><p>For line and ribbon plots, whether to smooth the lines by
drawing an X-spline relative to control points. In the background
<code><a href="geom_linespline.html">geom_linespline</a></code> and <code><a href="geom_ribbonspline.html">geom_ribbonspline</a></code> are used.</p></dd>


<dt>...</dt>
<dd><p>Other arguments passed to methods.</p></dd>


<dt>quantiles</dt>
<dd><p>For <code>geom = "ribbon"</code>, or <code>geom = "col"</code>, the quantiles
used to stratify the probabilities of an ensemble forecast.</p></dd>


<dt>best_guess</dt>
<dd><p>What to plot as a "best guess" forecast. Can be any
function as a character string that reduces a vector to a single value. Can
also be an ensemble member as a numeric value or a string that is the same
as the member in a <code>harp_ens_point_df</code> data frame that has had the
members pivoted using <code><a href="https://rdrr.io/pkg/harpCore/man/pivot_members.html" class="external-link">pivot_members</a></code>, e.g.
<code>"mbr000"</code>.</p></dd>


<dt>best_guess_geom</dt>
<dd><p>The geom to use to plot the best guess forecast.</p></dd>


<dt>best_guess_geom_args</dt>
<dd><p>Arguments to <code>best_guess_geom</code> as a named list.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A ggplot object that can be saved with <code>ggasve</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="geoms">Geoms<a class="anchor" aria-label="anchor" href="#geoms"></a></h2>
    


<p>The data are plotted using geoms from ggplot2. You can control which geom
is used for each aspect of the plot using the respective arguments:</p><ul><li><p><code>fcst_geom</code> for forecast;</p></li>
<li><p><code>obs_geom</code> for observations;</p></li>
<li><p><code>best_guess_geom</code> for the "best guess" forecast from an ensemble.</p></li>
</ul><p>The geom should be specified as a character string based on the geom
function from ggplot2 with the "geom_" prefix removed. For example, for a
line plot for forecast data use <code>fcst_geom = "line"</code>. Other arguments to
the geom function can be provided as named list to the appropriate
<code>*_geom_args</code> argument to control, for example, the colour or size of the
geom.</p>
<p>Note that aesthetic mappings to the geom cannot be controlled, except for
<strong>x</strong> via the <code>x_axis</code> argument and <strong>colour</strong> and <strong>fill</strong>
via the <code>colour_by</code> argument.</p>
    </div>
    <div class="section level2">
    <h2 id="ensembles">Ensembles<a class="anchor" aria-label="anchor" href="#ensembles"></a></h2>
    


<p>For ensemble forecasts, some data manipulation is done prior to plotting
depending on the geom as listed below. For geoms not included below, no
manipulation is done and the plots may be difficult to interpret or not
work at all.</p><ul><li><p><strong>boxplot</strong> - The data are grouped by the <code>x_axis</code> argument such
that each box is representative of the ensemble distribution for each point
on the x-axis. See <code><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></code> for how the hinges,
whiskers and outliers are defined.</p></li>
<li><p><strong>violin</strong> - The data are grouped by the <code>x_axis</code> argument such
that each "violin" is representative of the ensemble distribution for each
point on the x-axis.</p></li>
<li><p><strong>line</strong> - The data are grouped by each ensemble member and a time
series is plotted for each member. This is the common ensemble "spaghetti"
plot.</p></li>
<li><p><strong>ribbon</strong> - The data are divided into bands depending on the
quantiles provided in the <code>quantiles</code> argument. The bands are centred such
that the the outer band is between the lowest and highest quantiles with
inner bands added until the innermost pair of quantiles is reached.
Consequently an even number of quantiles must be provided.</p></li>
<li><p><strong>col</strong> - The data are divided into bands of increasing quantile
pairs starting provided in the <code>quantiles</code> argument, with the minimum value
(quantile = 0). This gives columns of stacked probabilities staring at 0
that is particularly useful for accumulated variables such as
precipitation, or variables that truncate at 0 such as wind speed or cloud
or cloud cover.</p></li>
</ul><p>A "best_guess" forecast can be added to the plot using the <code>best_guess</code>
argument. This can either be the name of a function that reduces the
ensemble to a single value (e.g. "mean", "median"), or the ensemble member
to treat as the best guess (e.g. 0, or "mbr000"). The geom and its options
can be provided via the <code>best_guess_geom</code> and <code>best_guess_geom_args</code>
arguments, but they must be geoms that understand the <strong>x</strong> and
<strong>y</strong> aesthetics.</p>
    </div>
    <div class="section level2">
    <h2 id="filtering-and-faceting">Filtering and faceting<a class="anchor" aria-label="anchor" href="#filtering-and-faceting"></a></h2>
    


<p>By default, all of the data that the function is given are plotted. In many
cases this can result in overplotting. For data at more than one station
(SID), or for more than one forecast start time (fcst_dttm), there are
arguments to filter the data prior to plotting based on those values.
Otherwise filtering should be done (e.g. using <code><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></code>)
prior to passing the data to this function.</p>
<p>Alternatively multi-panel plots can be made using the <code>facet_by</code> argument.
This groups the data based on the values in the columns provided to
<code>facet_by</code> and plots each group of data in its own panel. The default
behaviour is to plot 1 column of panels so that the x axis lines up for all
panels, but this can be changed using the <code>num_facet_cols</code> argument.
Additionally, the scale of the y axis for each panel is determined by the
data for that panel, but can be common for all panels by setting
<code>facet_scales = "fixed"</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="observations">Observations<a class="anchor" aria-label="anchor" href="#observations"></a></h2>
    


<p>If the data include an observations column (e.g. from running
<code><a href="https://rdrr.io/pkg/harpCore/man/join_to_fcst.html" class="external-link">join_to_fcst</a></code>), these observations can be included
in the plot be providing the name of the column that contains the
observations via the <code>obs_col</code> argument. The geom and its options can be
provided via the <code>obs_geom</code> and <code>obs_geom_args</code> arguments, but they must be
geoms that understand the <strong>x</strong> and <strong>y</strong> aesthetics.</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Andrew Singleton.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

